# 15日間スケジュール案（8時間×15日・甘め）

**前提**: 設計書の全機能は厳しいため、**認証をアピールポイント**に据えつつ、動くデモとポートフォリオで説明できる範囲に絞ります。  
**報告**: 2週間ごとに成果物を報告する想定で、スケジュールと「2週間で何ができるか」を明示しています。

---

## 「CRUD 先行」で進める場合（Python 学習中の方）

**結論: 先にタスク CRUD API を作り、そのあとログイン周りを入れる進め方で問題ありません。**

### よい点
- Python / FastAPI / SQLAlchemy に慣れるのに、**認証なしの CRUD** のほうが負荷が小さい。
- ルーティング・Pydantic・DB の流れを理解してから、JWT や `get_current_user` を足す方が理解しやすい。
- 「動く API」を早く作れるので、フロントや Postman で試しやすい。

### 進めるときのコツ
1. **DB は最初から本番形で**  
   `users`, `teams`, `tasks` を ER 図どおりに作り、`tasks` の `created_by` / `user_id` も FK で持っておく。あとから認証を入れてもスキーマ変更が不要になる。
2. **CRUD 時は「仮のユーザー」でよい**  
   認証がない間は、`created_by` や `user_id` には「シードで 1 件入れておいたテスト用ユーザーの ID」を固定で入れてもよい。ログイン API を入れたあと、その部分を「`get_current_user` の id に差し替える」だけにする。
3. **認証を入れるときの作業**  
   - `POST /auth/login` と JWT、`get_current_user`（Depends）を実装。  
   - 各タスク API に `get_current_user` を依存に追加し、`created_by` の設定や「本人のみ」のチェックをそこから取得したユーザーで行う。  
   既存の CRUD の「形」は変えず、**依存の追加と 1 箇所の差し替え**で済む。

### 順序の目安（CRUD 先行の場合）
- **Day 1–2**: Docker・DB・モデル（変更なし）
- **Day 3–5**: タスクの **GET/POST/GET(id)/PATCH/DELETE**（認証なし、created_by は仮ユーザー ID で OK）
- **Day 6–7**: フロントからタスク API を叩いて一覧・作成・編集・削除（Authorization ヘッダーはまだ不要）
- **Day 8 以降**: ログイン API・JWT・`get_current_user` を実装し、タスク API に「認証必須」と「created_by = ログインユーザー」を追加。その後、認可ロジック（権限マトリクス）へ。

この順序にすると、**「まず CRUD で Python に慣れる → そのあと認証でセキュリティを足す」**という流れで無理なく進められます。

---

## 2週間ごとの報告用：成果物と「何ができるか」

### 第1回報告（1〜2週目・10営業日終了時）

**この時点でできること**
- Docker Compose で DB とバックエンドが起動する。
- ログイン API が動き、フロントのログイン画面からログインして JWT を取得できる。
- タスクの一覧・作成・詳細・更新・削除の API が動き、フロントから一通り操作できる（ログイン必須）。
- 未ログイン時はログイン画面へリダイレクト、ログアウトができる。

**報告時に伝えるとよいこと**
- 「ログインして、自分のタスクの一覧・作成・編集・削除ができるところまで完了しました。」
- 「次は、管理者・リーダー・一般で『見えるタスク』と『編集できる範囲』を変える認可ロジックを入れます。」

---

### 第2回報告（3週目・15営業日＝全体終了時）

**この時点でできること**
- ロール（Admin / Leader / User）でタスク一覧の表示範囲が変わる（管理者＝全件、リーダー＝自チーム、一般＝自分関連のみ）。
- 一般ユーザーは他人のタスクは「ステータスのみ更新可」など、権限マトリクスに沿った制限がかかっている。
- フロントでロールに応じたボタン・フォームの出し分け、権限エラー時のメッセージ表示。
- サンプルデータ（チーム・ユーザー・タスク）の投入手順と README（起動方法・権限の考え方）の整備。

**報告時に伝えるとよいこと**
- 「役割ごとに見えるタスクと操作できる範囲が変わるようにしました。権限をバックエンドの 1 箇所で管理し、API と画面の両方で同じルールが動いています。」
- 「README に権限マトリクスと、どこで効いているかを書きました。」

---

### 「2週間で何ができるか」のまとめ

| 期間 | できること（要約） |
|------|---------------------|
| **1〜2週目** | 環境構築、ログイン（JWT）、タスクの CRUD、フロントと API の接続、未認証時リダイレクト。**「ログインしてタスクを触れる」まで。** |
| **3週目** | ロール別の一覧・編集制限、フロントの権限出し分け、サンプルデータ、README とデモ用の整理。**「権限に応じた動き」と説明資料。** |

講師向けの詳細説明（技術スタック、言語、業務フロー、2週間ごとの成果物）は **`docs/APP_OVERVIEW_FOR_INSTRUCTOR.md`** にまとめてあります。

---

## 15日後のゴール（達成したい姿）

| 項目 | 内容 |
|------|------|
| **認証（アピールの核）** | ログイン（JWT）、ロール（Admin/Leader/User）に応じたAPI・画面の出し分けが一通り動く。README で「権限マトリクスを意識した設計」を書ける。 |
| **タスク** | 一覧・作成・詳細・更新・削除が可能。一覧は「ロールとユーザー」で見える範囲が変わる（一般＝自分のタスク中心、リーダー＝チーム内、管理者＝全部）。 |
| **環境** | Docker Compose で DB + バックエンドが起動し、フロントからログイン→タスク操作まで一連の流れが体験できる。 |
| **割愛・簡略化** | 10万件データは行わず数百〜数千件のサンプルで可。チーム管理は「閲覧・一覧」程度。検索・ソートは簡易実装。UI は Tailwind で整える程度（shadcn は余裕があれば）。 |

---

## 週ごとのテーマと報告タイミング（CRUD 先行）

| 週 | テーマ | 主な成果物 | 報告 |
|----|--------|------------|------|
| **1週目** | 土台＋タスク CRUD（認証なし） | Docker・DB・モデル・タスクの GET/POST/GET(id)/PATCH/DELETE（認証なし）。フロントから一覧・新規・詳細・編集・削除ができる。 | — |
| **2週目** | 認証を足す＋認可の核 | ログイン API・JWT・get_current_user。タスク API を「認証必須」にし、created_by をログインユーザーに。認可ロジック（permissions）とロール別一覧・編集制限。 | **Day 10 終了時：第1回報告**（ログイン＋タスク CRUD 認証必須まで） |
| **3週目** | 仕上げ・アピール | サンプルデータ、簡易検索・ページネーション、README・デモ用の整理。 | **Day 15 終了時：第2回報告**（権限出し分け・説明資料まで） |

---

## 日別スケジュール（1日＝8時間・CRUD 先行・フロント／バック分け）

### 1週目：土台＋タスク CRUD（認証なし）

| 日 | ゴール | バックエンドでやること | フロントエンドでやること |
|----|--------|------------------------|--------------------------|
| **Day 1** | Docker と DB が動く | docker-compose で db + backend 起動確認。config.py で DATABASE_URL 読み込み。db/session.py で SQLAlchemy エンジン・SessionLocal・get_db を実装。main で get_db を試す。 | （任意）docker-compose に frontend を追加し、next が起動するだけの確認。 |
| **Day 2** | テーブルが存在する | models/team.py, user.py, task.py を ER 図どおりに定義。db/base.py で Base。起動時に create_all または Alembic でマイグレーション。**テスト用ユーザーを 1 件シード**（created_by 用）。 | （任意）型定義（types/task.ts 等）を API 仕様に合わせて整える。 |
| **Day 3** | タスク一覧・作成 API | schemas/task.py で Pydantic（TaskCreate, TaskResponse 等）。GET /tasks（認証なし・全件 or 簡易フィルタ）。POST /tasks（title, description, status, priority, user_id 等、created_by は**仮ユーザー ID で固定**）。routers/tasks.py を main に登録。 | タスク一覧ページ（/tasks）の骨組み。lib/api/client.ts で BASE_URL のみ。lib/api/tasks.ts で GET /tasks を呼ぶ（ヘッダーなしで OK）。一覧表示。 |
| **Day 4** | タスク詳細・更新・削除 API | GET /tasks/{id}、PATCH /tasks/{id}、DELETE /tasks/{id}（いずれも**認証なし**）。論理削除（deleted_flag）は GET で除外。 | 一覧から詳細へ（/tasks/[id]）。GET /tasks/{id} で詳細表示。編集フォームと PATCH、削除ボタンと DELETE を実装。新規作成（/tasks/new）と POST /tasks の接続。 |
| **Day 5** | バック調整・フロント繋ぎ | CORS 設定。エラーレスポンスの統一。必要なら Pydantic バリデーション調整。 | lib/api/tasks.ts に POST /tasks, PATCH /tasks/{id}, DELETE /tasks/{id} を追加。一覧・新規・詳細・編集・削除の流れを通して動作確認。 |
| **Day 6** | 1週目仕上げ | （余裕）GET /tasks に limit, offset を追加。 | （余裕）UI の見た目調整。**マイルストーン**：フロントからタスクの一覧・新規・詳細・編集・削除が一通りできる。 |
| **Day 7** | バッファ・予備日 | Day 1–5 の不具合修正。README に「バックエンド起動方法」を 1 行。 | Day 1–5 の不具合修正。**第1週目標**：認証なしでタスク CRUD がフロントから操作できる状態。 |

### 2週目：認証を足す＋認可の核

| 日 | ゴール | バックエンドでやること | フロントエンドでやること |
|----|--------|------------------------|--------------------------|
| **Day 8** | ログイン API が動く | core/security.py：パスワードハッシュ（bcrypt）、JWT 発行・検証。routers/auth.py：POST /auth/login（email, password）→ Token と user（id, name, role, team_id）。core/dependencies.py：get_current_user（Bearer からユーザー取得）。 | ログイン画面（/login）のフォーム。lib/api/auth.ts で POST /auth/login を呼び、トークンと user を保存（localStorage 等）。ログイン成功後 /tasks へリダイレクト。 |
| **Day 9** | タスク API を認証必須に | 各タスク API に get_current_user を Depends で追加。POST /tasks の created_by を**ログインユーザー id に差し替え**。GET /tasks は一旦「全件」または「ログインユーザー関連」でよい。GET/PATCH/DELETE /tasks/{id} も認証必須に。 | lib/api/client.ts で Authorization ヘッダー（Bearer トークン）を付与。トークンがなければ /login へリダイレクト。ログアウト（トークン削除＋/login）。 |
| **Day 10** | 認可ロジックをコードに | core/permissions.py：can_view_task / can_edit_task / can_delete_task を「Admin / Leader / User × タスクの created_by・user_id・チーム」で判定。権限マトリクス表に沿う。 | AuthContext で user（id, name, role, team_id）を保持。ヘッダーにロール表示。**第1回報告**：ログインしてタスクの一覧・作成・編集・削除ができるところまで。 |
| **Day 11** | タスク API に認可を反映 | GET /tasks：Admin=全件、Leader=自チーム内、User=自分が created_by または user_id のタスクのみ。GET/PATCH/DELETE /tasks/{id}：permissions で判定。「一般は他人タスクは Status のみ更新可」を実装。 | ロール別で一覧件数が変わることを確認。他人タスクで「一般」のときは編集を「ステータスのみ」に制限したフォーム or ボタン非表示。権限エラー時にメッセージ表示。 |
| **Day 12** | サンプルデータと動作確認 | scripts/seed_data.py：チーム 3、ユーザー 10〜20（Admin/Leader/User）、タスク 500〜2000（created_by・user_id をランダムに）。実行手順を README に記載。 | Admin / Leader / User でそれぞれログインし、一覧・詳細・編集の挙動が変わることを目視確認。 |

### 3週目：仕上げ・アピール

| 日 | ゴール | バックエンドでやること | フロントエンドでやること |
|----|--------|------------------------|--------------------------|
| **Day 13** | 簡易検索・一覧の使い心地 | GET /tasks に query パラメータ（status, user_id, limit, offset）を追加。ORDER BY created_at。 | 一覧画面にステータスフィルタ・ページネーション（Next/Prev）を追加。API の limit/offset を渡す。 |
| **Day 14** | README とアピール用整理 | README に「起動方法」「権限マトリクス（表）」「認可が効いている API 一覧」を記載。環境変数（DATABASE_URL, JWT_SECRET）の説明。 | README にフロントの起動方法・環境変数（NEXT_PUBLIC_API_URL）。画面キャプチャ or デモ GIF があるとよい。 |
| **Day 15** | デモ・最終チェック | 全 API の通し確認。ポートフォリオ用に「認証・認可の設計」を 1 分で説明できるように整理。 | 通しで操作（ログイン→一覧→新規→詳細→編集→ロール変えて再確認）。説明用のスクリプト or メモを用意。**第2回報告**。 |

---

## 達成時のアピールポイント（ポートフォリオ・面接用）

### バックエンドのアピールポイント

| 観点 | 説明の仕方 |
|------|------------|
| **認証・認可の設計** | 「JWT でログインし、FastAPI の Depends で `get_current_user` を共通化。認可ロジックは `core/permissions.py` に集約し、権限マトリクス（Admin/Leader/User × 操作対象）を 1 箇所で管理しています。」 |
| **セキュリティ** | 「パスワードは bcrypt でハッシュ保存。API は Bearer トークン必須。タスクの取得・更新・削除はロールと created_by/user_id/チームで判定し、一般ユーザーが他人タスクを消したり全項目編集できないようにしています。」 |
| **API 設計** | 「REST に沿ったタスク CRUD。GET /tasks はロールで WHERE 句を変え、一覧の見える範囲をサーバー側で制御。PATCH では『Status のみ可』の場合は他フィールドを変更しようとするとエラーにしています。」 |
| **インフラ** | 「Docker Compose で PostgreSQL と FastAPI を定義し、DB の healthcheck 後にバックエンドが起動するようにしています。接続情報は環境変数で渡しています。」 |

**見せ所コード**: `core/permissions.py`、`core/dependencies.py`、`routers/tasks.py` の「ロール別 WHERE」「操作可否チェック」の数か所。

---

### フロントエンドのアピールポイント

| 観点 | 説明の仕方 |
|------|------------|
| **認証フロー** | 「ログイン後に JWT を保存し、API クライアントで Authorization ヘッダーに付与。Context でログインユーザー（id, role）を保持し、未認証時は /login へリダイレクトするガードを入れています。」 |
| **権限に応じた UI** | 「ロール（Admin/Leader/User）に応じて、タスクの『編集可』『ステータスのみ変更可』を出し分け。他人のタスクで一般ユーザーが触れるのはステータスだけになるよう、フォームやボタンを制御しています。」 |
| **技術スタック** | 「Next.js App Router、TypeScript、Tailwind CSS。ルートは /login、/tasks、/tasks/new、/tasks/[id] で設計書どおりに構成しています。」 |
| **API 連携** | 「バックエンドの REST API を fetch で利用。エラー時（401/403）のハンドリングと、権限エラー時のメッセージ表示を実装しています。」 |

**見せ所**: ログイン→タスク一覧→ロールを変えて再ログインしたときの「見えるタスク数・編集できる範囲」の違いをデモで見せる。

---

## 認証まわりで「アピール」しやすいポイント（補足）

1. **設計の説明**  
   README に「Admin / Leader / User の権限マトリクスを backend の permissions 層で一括管理し、API とフロントの両方で一貫して使っている」と書く。

2. **実装の見せ所**  
   - ログイン → JWT → 各 API の `get_current_user` でロール取得  
   - GET /tasks のクエリをロールで切り替え（コードの該当箇所を 1〜2 ファイルにまとめておく）  
   - フロントで「一般ユーザーは他人タスクで編集ボタンを出さない／ステータスのみ」など

3. **割り切る部分**  
   - パスワードリセット、メール認証、OAuth は対象外  
   - チームの「作成・編集」は未実装でよい（「閲覧・一覧」だけでも可）  
   - 10万件・高度な検索最適化は省略

---

## 進め方のコツ

- **毎日終わりに「今日のゴール」が 1 つでも達成できていれば OK** とする。
- **マイルストーン**  
  - **Day 7**：認証なしでタスク CRUD がフロントから一通り操作できる。  
  - **Day 10**：ログイン必須になり、第1回報告。「次はロールで見える範囲を変える認可」を伝える。  
  - **Day 15**：ロール別の表示・編集制限と README が整い、第2回報告。
- 認証・認可のコードは `core/` と `routers/tasks` に集約し、**後から「ここがアピールポイントです」と説明しやすい形**にしておく。

このスケジュールで進めれば、**CRUD 先行で Python に慣れつつ、8時間×15日で「認証を軸にした、説明できるデモ」**を目標にできます。
